<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Script-Type" content="text/javascript">
  <meta http-equiv="content-language" content="ja">
  <script src="encoding.min.js"></script>
  <title>行事予定表メーカー　～柳～</title>
  <style type="text/css">
    body {
      background-color: #fafafa;
    }

    td {
      height: 27px;
      text-align: center;
      vertical-align: middle;
    }

    td#cell1t {
      background-color: #eeeeee;
      border: 0px #333333 solid;
      color: #333333;
      width: 22px;
      font-size: 0.8em;
      font-family: "ＭＳ ゴシック", "Kosugi", monospace;
    }

    td#cell2t {
      background-color: #ffffff;
      border: 0px #333333 solid;
      color: #333333;
      width: 22px;
      font-size: 0.8em;
      font-family: "ＭＳ ゴシック", "Kosugi", monospace;
    }

    td#cell3t {
      background-color: #ffffff;
      border: 0px #333333 solid;
      color: #333333;
      width: 205px;
      font-size: 0.8em;
      font-family: "ＭＳ ゴシック", "Kosugi", monospace;
      border-collapse: collapse;
    }

    td#cell4t {
      background-color: #ffffff;
      border: 0px #333333 solid;
      color: #333333;
      width: 85px;
      font-size: 0.8em;
      font-family: "ＭＳ ゴシック", "Kosugi", monospace;
      white-space: nowrap;
    }


    td.cell1 {
      background-color: #eeeeee;
      border: 0px #333333 solid;
      color: #333333;
      width: 23px;
      font-size: 1em;
    }

    td.cell2 {
      background-color: #ffffff;
      border: 0px #333333 solid;
      color: #333333;
      width: 22px;
      font-size: 1em
    }

    td.cell2a {
      background-color: #00ffff;
      border: 0px #333333 solid;
      color: #333333;
      width: 22px;
      font-size: 1em
    }

    td.cell2b {
      background-color: #ff00ff;
      border: 0px #333333 solid;
      color: #000000;
      width: 22px;
      font-size: 1em
    }

    td.cell3 {
      background-color: #ffffff;
      border: 0px #333333 solid;
      color: #333333;
      width: 205px;
      font-size: 0.8em;
      text-align: left;
      border-collapse: collapse;
    }

    td.cell3a {
      background-color: #ffffff;
      border: 0px #333333 solid;
      color: #ff0000;
      width: 205px;
      font-size: 0.8em;
      text-align: left;
      border-collapse: collapse;
    }

    td.cell3b {
      background-color: #ffffff;
      border: 0px #333333 solid;
      color: #0000ff;
      width: 205px;
      font-size: 0.8em;
      text-align: left;
      border-collapse: collapse;
    }

    td.cell4 {
      background-color: #ffffff;
      border: 0px #333333 solid;
      color: #333333;
      width: 85px;
      font-size: 0.8em;
      text-align: left;
      white-space: nowrap;
    }

    button.img {
      padding: 0;
      border: none;
      *width: 200px;
      /* for IE6-7 */
      *height: 60px;
      /* for IE6-7 */
      background: transparent;
    }

    button.img:moz-focusring {
      outline: 1px dotted #000;
    }

    button img {
      display: block;
    }

    img {
      width: 200px;
      height: 60px;
    }

    textarea {
      font-size: 1.2rem;
      font-family: "ＭＳ ゴシック", "Kosugi", monospace;
      width: 100%;
    }

    table#table {
      background-color: #333333;
      border: 0.5px #333333 solid;
    }

    .dayS {
      font-weight: bold;
      font-size: larger;
    }
  </style>
</head>

<body>
  <table>
    <tbody>
      <tr>
        <td style="text-align: left;">
          以前に作成したファイルをロード:<input type="file" accept=".txt" id="roaderA" disabled="true" />
        </td>
        <td style="text-align: left;">
          HTMLファイルを読み込む:<input type="file" accept=".html,.htm" id="roaderB" disabled="true" />
        </td>
      </tr>
      <tr id="owtr" style="display: none;">
        <td style="text-align: left;">
          表がリセットされますが、よろしいですか？<label><input type="checkbox" id="overwrite" />はい</label>
        </td>
      </tr>
    </tbody>
  </table>
  <center><br><br>
    <button type="button" class="img" id="startbtn">
      <img src="data:image/gif;base64,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" alt="始める" />
    </button><br>
    <span class="dayS">
      <input id="yearin" type="text" minlength="4" maxlength="4" size="4" placeholder="年" />年
      <input id="monthin" type="text" minlength="1" maxlength="2" size="2" placeholder="月" />月
    </span>
    <br>
    <table>
      <tbody id="tbd">
        <tr id="csins">
          <td colspan="4" style="text-align: right;">
            <button type="button" id="addct">新しいカスタムテキストを挿入</button>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <table border="1" id="table">
      <tbody id="tbody">
        <tr>
          <td id="cell1t">日</td>
          <td id="cell2t">曜日</td>
          <td id="cell3t" colspan="2">行　　事　　予　　定</td>
          <td id="cell4t">時　間　割</td>
        </tr>
      </tbody>
    </table><br>
    <button type="button" class="img" id="outbtn">
      <img src="data:image/gif;base64,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" class="buttons" alt="出力" />
    </button>
    <button type="button" class="img" id="cpbtn">
      <img src="data:image/gif;base64,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" class="buttons" alt="クリップボードにコピー" />
    </button><br><br>
    <textarea id="texa" cols="70" rows="20" wrap="off"></textarea><br><br>
    <table>
      <tbody>
        <tr>
          <td>
            <button type="button" class="img" id="exbtn" disabled="true">
              <img src="data:image/gif;base64,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" class="buttons" alt="書き出し" />
            </button>
          </td>
        </tr>
        <tr id="ex0disp" style="display: none;">
          <td>
            <button type="button" class="img" id="exbtn0">
              <img src="data:image/gif;base64,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" alt="HTMLファイルを書き出し" />
            </button>
          </td>
          <td style="vertical-align: middle; text-align: left;">
            <label><input type="radio" name="opt" disabled="true" />行う処理(備考)</label><br>
            <label><input type="radio" name="opt" id="preferShiftJIS" disabled="true" />Shift-JISで書き出す(IE11以上対応)</label><br>
            <label><input type="radio" name="opt" id="replaceCharsetUTF8" checked="true" />metaのcharsetを
              <select id="charsetSelect">
                <option value="UTF-8">UTF-8</option>
                <option value="Shift-JIS">Shift-JIS</option>
              </select>
              に置き換える(既定)</label><br>
            <label><input type="radio" name="opt" id="justUTF8" />何もしない(高度)</label>
          </td>
        </tr>
      </tbody>
    </table><br><br>
    <textarea id="logarea" cols="70" rows="5" wrap="off"></textarea>
  </center>
  <label><input type="checkbox" id="logReverse" />ログの追加方向を反転する</label>
  <script type="text/javascript">
    var table = document.getElementById('table');
    var tbody = document.getElementById('tbody');
    var tarea = document.getElementById('texa');
    var dllink = document.createElement('a');
    var monthin = document.getElementById('monthin');
    var yearin = document.getElementById('yearin');
    var roaderA = document.getElementById('roaderA');
    var roaderB = document.getElementById('roaderB');
    var exbtn0 = document.getElementById('exbtn0');
    var ex0disp = document.getElementById('ex0disp');
    var owbox = document.getElementById('overwrite');
    var owtr = document.getElementById('owtr');
    var pSJIS = document.getElementById('preferShiftJIS');
    var rCUTF8 = document.getElementById('replaceCharsetUTF8');
    var jUTF8 = document.getElementById('justUTF8');
    var cset = document.getElementById('charsetSelect');
    var trcn = tbody.getElementsByTagName('tr');
    var trcn2 = document.getElementById('tbd').getElementsByTagName('tr');

    var ckd = ['true', 'false', 'false'];
    var dclw = [['赤', '白', '青'], ['白', '赤', '青'], ['白', '赤', '青'], ['白', '赤', '青'], ['白', '赤', '青'], ['白', '赤', '青'], ['青', '白', '赤']];
    var dcvw = [['fuchsia', 'white', 'aqua'], ['white', 'fuchsia', 'aqua'], ['white', 'fuchsia', 'aqua'], ['white', 'fuchsia', 'aqua'], ['white', 'fuchsia', 'aqua'], ['white', 'fuchsia', 'aqua'], ['aqua', 'white', 'fuchsia']];
    var textcolorsName = ['黒', '赤', '青'];
    var textcolorsClasses = ['black', 'red', 'blue'];
    var bases = ['', '月123456', '火123456', '水123456', '木12345', '金123456', ''];
    var datelist = ['fuchsia', 'white', 'white', 'white', 'white', 'white', 'aqua'];
    var datelist2 = ['日', '月', '火', '水', '木', '金', '土'];
    var datelist3 = ['cell2b', 'cell2', 'cell2', 'cell2', 'cell2', 'cell2', 'cell2a'];
    var la = [''];
    var lb = [''];
    var lc = [''];
    var ld = [''];
    var alltext = ['          <font size=\"+1\" color=\"#000099\">'];
    var objectURL, files, rYear, rMonth, fArrayWeek, fArrayTodo, fArraySchdulevar, blob_content, fReader, fReader0, blob;
    var tableLive = false;
    var replacetext1 = '<td align=\"center\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"19\" style=\"color\u003a \u0023000000\u003b background-color\u003a ';
    var replacetext2 = /\u003b\">.<\u002ftd>/;
    var replacetext3 = '<td align=\"left\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"171\" colspan=\"2\" style=\"color\u003a ';
    var replacetext4 = /\u003b\">.*?<\u002ftd>/;
    var replacetext5 = /<td align=\"left\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"171\" colspan=\"2\" style=\"color\u003a \w+?;\">/;
    var replacetext6 = '<td align=\"left\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"86\">';
    var replacetext7 = /\s{10}<font\ssize=\u0022\u002b1\u0022\scolor=\u0022\u0023000099\u0022>[\w\W]*?\u002ftbody>/;
    var replacetext8 = /charset=[\w\d-]*\"/;
    var replacetext9 = '行事予定表メーカー ～柳～ \[Version 1.0\] 2024' + '\n' + '----------ログ表示エリア----------' + '\n';
    var replacetext11 = /<span style=\"color: (\w+-?\w+?|#\d{3,6});( \w+-?\w+?: (\w+-?\w+?( \w+-\w+)?|#\d{3,6});)+\">/;
    var replacetext12 = /<\/span>/;
    var matchRegxp1 = /<td align=\"center\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"19\" style=\"color\u003a \u0023000000\u003b background-color\u003a \w*\u003b\">.<\u002ftd>/g;
    var matchRegxp2 = /<td align=\"left\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"171\" colspan=\"2\" style=\"color\u003a \w*\u003b\">.*?<\u002ftd>/g;
    var matchRegxp3 = /<td align=\"left\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"86\">.*?<\u002ftd>/g;
    var matchRegxp4 = /<span style=\"color: (\w+-?\w+?|#\d{3,6});( \w+-?\w+?: (\w+-?\w+?( \w+-\w+)?|#\d{3,6});)+\">[\w\W]+?<\/span>/g;
    var matchRegxp5 = /color: (\w+-?\w+?|#\d{3,6});( \w+-?\w+?: (\w+-?\w+?( \w+-\w+)?|#\d{3,6});)+/;//スタイル属性抜出
    var matchRegxp6 = /[\w-]*?: [\w\d# -]*?;/g;//5からそれぞれの値で分ける


    var ldt = new Date();
    var ly = ldt.getFullYear();
    var lm = ldt.getMonth() + 1;
    yearin.value = ly;
    monthin.value = lm;
    var y = yearin.value;
    var mb = monthin.value;
    var m = mb - 1;
    var newDate = new Date(y, mb, 1);
    newDate.setFullYear(y);
    newDate.setMonth(mb);
    newDate.setDate(0);
    var l = newDate.getDate() + 1;
    var ll = newDate.getDate();
    var filename = y + '_' + mb;
    var trueIE = false;
    if (navigator.userAgent.indexOf('MSIE') > -1 || navigator.userAgent.indexOf('Trident/') > -1) {
      trueIE = true;
    }

    if (trueIE) {
      String.prototype.padStart = function padStart(targetLength, padString) {
        targetLength = targetLength >> 0; //truncate if number, or convert non-number to 0;
        padString = String(typeof padString !== 'undefined' ? padString : ' ');
        if (this.length >= targetLength) {
          return String(this);
        } else {
          targetLength = targetLength - this.length;
          if (targetLength > padString.length) {
            padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed
          }
          return padString.slice(0, targetLength) + String(this);
        }
      };
    }

    function alltext_set() {
      alltext = ['          <font size=\"+1\" color=\"#000099\">'];
      alltext.push('            <b>～ ' + mb + '月　行　事　予　定　表　～&nbsp;</b><br></font>');
      alltext.push('          <font size=\"2\">※変更の可能性もあります。</font>');
      var ctext = [];
      for (i in nts) {
        var textsfor = new Object();
        textsfor.content = dgEBI('ct' + nts[i] + 'tv').value;
        if (textsfor.content.length != 0) {
          textsfor.color = (function () {
            if (dgEBI('ct' + nts[i] + 'sc16').checked == true) {
              return dgEBI('ct' + nts[i] + 's16v').value;
            } else if (dgEBI('ct' + nts[i] + 'scc').checked == true && (dgEBI('ct' + nts[i] + 'sccv').value.length == 3 || dgEBI('ct' + nts[i] + 'sccv').value.length == 6)) {
              return '#' + dgEBI('ct' + nts[i] + 'sccv').value;
            } else {
              addToLog('文字色の設定を正常に読み取れなかったため、「黒」として処理します。([' + i + ']番目)');
              return 'black';
            }
          }());
          textsfor.size = (function () {
            if (dgEBI('ct' + nts[i] + 'stsn').checked == true) {
              return dgEBI('ct' + nts[i] + 'stsnv').value;
            } else if (dgEBI('ct' + nts[i] + 'stsc').checked == true && !(dgEBI('ct' + nts[i] + 'sccv').value == null || dgEBI('ct' + nts[i] + 'sccv').value == '')) {
              return dgEBI('ct' + nts[i] + 'stsv').value + dgEBI('ct' + nts[i] + 'stsvs').value;
            } else {
              addToLog('文字サイズの設定を正常に読み取れなかったため、「大」として処理します。([' + i + ']番目)');
              return 'large';
            }
          }());
          textsfor.ext = new Object();
          textsfor.ext.b = dgEBI('ct' + nts[i] + 'seb').checked;
          textsfor.ext.i = dgEBI('ct' + nts[i] + 'sei').checked;
          textsfor.ext.u = dgEBI('ct' + nts[i] + 'seu').checked;
          textsfor.ext.s = dgEBI('ct' + nts[i] + 'ses').checked;
          ctext.push(textsfor);
        } else { addToLog('カスタムテキストが空のためスキップします。([' + i + ']番目)'); }
      }

      for (i in ctext) {
        alltext.push((function () {
          var cbefore, cafter;
          var s = '<span style="color: ' + ctext[i].color + '; font-size: ' + ctext[i].size + ';';
          if (ctext[i].ext.b == true) { s = s + ' font-weight: bold;'; }
          if (ctext[i].ext.i == true) { s = s + ' font-style: italic;'; }
          if (ctext[i].ext.u == true && ctext[i].ext.s == true) {
            s = s + ' text-decoration: underline line-through;';
          } else if (ctext[i].ext.u == true) {
            s = s + ' text-decoration: underline;';
          } else if (ctext[i].ext.s == true) {
            s = s + ' text-decoration: line-through;';
          }
          if (i == 0) {
            cbefore = '          ';
            cafter = '<!--';
          } else {
            cbefore = '       -->';
            cafter = '<!--';
          }
          if (i == ctext.length - 1) {
            cafter = '';
          }
          s = cbefore + s + '">' + ctext[i].content + '</span>' + cafter;
          return s;
        }()));
      }
      alltext.push('          <table height=\"780\" width=\"316\" border=\"1\" bgcolor=\"#FFFFFF\" class=\"hpb-cnt-tb1\" id=\"HPB_TABLE_1_A_141101134510\">');
      alltext.push('            <tbody>');
      alltext.push('              <tr>');
      alltext.push('                <td align=\"center\" valign=\"middle\" class=\"hpb-cnt-tb-cell1\">');
      alltext.push('                  <font size=\"2\" color=\"#333333\" face=\"ＭＳ Ｐゴシック\">日</font></td>');
      alltext.push('                <td align=\"center\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"19\">');
      alltext.push('                  <font size=\"2\" color=\"#333333\" face=\"ＭＳ Ｐゴシック\">曜日</font></td>');
      alltext.push('                <td align=\"center\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"171\" colspan=\"2\">');
      alltext.push('                  <font size=\"2\" color=\"#333333\" face=\"ＭＳ Ｐゴシック\">行　　事　　予　　定</font></td>');
      alltext.push('                <td align=\"center\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"86\">');
      alltext.push('                  <font size=\"2\" color=\"#333333\" face=\"ＭＳ Ｐゴシック\">時　間　割</font></td>');
      alltext.push('              </tr>');
      la = [''];
      lb = [''];
      lc = [''];
    }

    alltext_set();

    function generating() {
      ld = [''];
      if (trcn.length != 1) {
        for (var i = 1; trcn.length != 1; i++) {
          tbody.removeChild(trcn[1]);
        }
      }
      for (var i = 1; i < l; i++) {
        var mewDate = new Date(y, m, i);
        var w = mewDate.getDay();
        var tr = document.createElement('tr');
        var a = 'a' + i;
        var b = 'b' + i;
        var c = 'c' + i;
        var d = 'd' + i;
        var e = 'e' + i;
        var f = 'cattr(\"' + d + '\",\"' + e + '\")';
        var g = 'javascript:insertBrTag(' + b + ')';

        var daytd = document.createElement('td');
        daytd.setAttribute('class', 'cell1');

        var datetd = document.createElement('td');
        datetd.setAttribute('class', datelist3[w]);
        datetd.setAttribute('style', 'background: ' + datelist[w] + ';');
        datetd.setAttribute('id', d);
        ld.push(datelist[w]);

        var selec = document.createElement('select');
        selec.setAttribute('onchange', f);
        selec.setAttribute('id', e);
        selec.setAttribute('style', 'background-color:transparent;');
        for (var num in ckd) {
          var option = document.createElement('option');
          option.text = dclw[w][num];
          option.value = dcvw[w][num];
          option.setAttribute('class', dcvw[w][num]);
          selec.appendChild(option);
        }

        var todotd = document.createElement('td');
        todotd.setAttribute('class', 'cell3');
        todotd.setAttribute('colspan', '2');

        var select = document.createElement('select');
        select.setAttribute('id', a);
        for (var num in textcolorsName) {
          var option = document.createElement('option');
          option.text = textcolorsName[num];
          option.value = textcolorsClasses[num];
          option.setAttribute('class', textcolorsClasses[num]);
          select.appendChild(option);
        }

        var brbutton = document.createElement('button');
        brbutton.setAttribute('type', 'button')
        brbutton.setAttribute('onclick', g)
        brbutton.innerText = '改行'

        var todoinput = document.createElement('input');
        todoinput.setAttribute('type', 'text');
        todoinput.setAttribute('size', '21')
        todoinput.setAttribute('id', b);

        var schtd = document.createElement('td');
        schtd.setAttribute('class', 'cell4');

        var schinput = document.createElement('input');
        schinput.setAttribute('type', 'search');
        schinput.setAttribute('size', '15');
        schinput.setAttribute('value', bases[w]);
        schinput.setAttribute('id', c);

        todotd.appendChild(select);
        todotd.appendChild(brbutton);
        todotd.appendChild(todoinput);
        schtd.appendChild(schinput);
        tr.appendChild(daytd);
        tr.appendChild(datetd);
        tr.appendChild(todotd);
        tr.appendChild(schtd);
        tbody.appendChild(tr);

        cTT(i, 0, i);
        cTT(i, 1, datelist2[w]);
        datetd.appendChild(selec);
        tableLive = true;
      }
    }

    function cTT(row1, cell1, text1) {
      table.rows[row1].cells[cell1].innerHTML = text1;
    }

    function addToLog(addText) {
      var lot = new Date();
      var alot = [lot.getFullYear(), String(lot.getMonth() + 1).padStart(2, '0'), String(lot.getDate()).padStart(2, '0'), String(lot.getHours()).padStart(2, '0'), String(lot.getMinutes()).padStart(2, '0'), String(lot.getSeconds()).padStart(2, '0')];
      var timestamp = '> ' + alot[0] + '/' + alot[1] + '/' + alot[2] + ' ' + alot[3] + ':' + alot[4] + ':' + alot[5] + '  ';
      var lv = logarea.value + '\n' + timestamp + addText;
      if (logReverse.checked == true) { var lv = logarea.value.replace(replacetext9, replacetext9 + '\n' + timestamp + addText); }
      logarea.value = lv;
    }

    var logtext = replacetext9;
    logarea.value = logtext;

    function cattr(cell, box) {
      var cel = document.getElementById(cell);
      var value = document.getElementById(box).value;
      var numb = parseFloat(cell.replace('d', ''));
      cel.style.background = value;
      ld.splice(numb, 1, value);
    }

    function insertBrTag(i) {
      var p = i.selectionStart;
      i.value = i.value.slice(0, p) + '<br>' + i.value.slice(p);
    }

    function fStartbtn() {
      y = yearin.value;
      mb = monthin.value;
      m = mb - 1;
      newDate = new Date(y, mb, 1);
      newDate.setFullYear(y);
      newDate.setMonth(mb);
      newDate.setDate(0);
      l = newDate.getDate() + 1;
      ll = newDate.getDate();
      filename = y + '_' + mb + '.txt';
      alltext_set();
      generating();
      addToLog(y + '年' + mb + '月の表を作成しました。');
    }

    var startbtn = document.getElementById('startbtn');
    if (startbtn.addEventListener) {
      startbtn.addEventListener('click', function () { fStartbtn() });
    } else if (startbtn.attachEvent) {
      startbtn.attachEvent('click', function () { fStartbtn() });
    }

    function fOutbtn() {
      if (tableLive) {
        alltext_set();
        for (var i = 1; i < l; i++) {
          var mewDate = new Date(y, m, i);
          var w = mewDate.getDay();
          var a = 'a' + i;
          var b = 'b' + i;
          var c = 'c' + i;
          la.push(document.getElementById(a).value);
          lb.push(document.getElementById(b).value);
          lc.push(document.getElementById(c).value);
        }
        for (var i = 1; i < l; i++) {
          var mewDate = new Date(y, m, i);
          var w = mewDate.getDay();
          alltext.push('              <tr>');
          alltext.push('                <td align=\"center\" valign=\"middle\" class=\"hpb-cnt-tb-cell1\">');
          alltext.push('                  <font color=\"#333333\" size=\"3\" face=\"\$ＪＳ明朝\">' + i + '</font></td>');
          alltext.push('                <td align=\"center\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"19\" style=\"color: #000000; background-color: ' + ld[i] + ';\">' + datelist2[w] + '</td>');
          alltext.push('                <td align=\"left\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"171\" colspan=\"2\" style=\"color: ' + la[i] + ';\">' + lb[i] + '</td>');
          alltext.push('                <td align=\"left\" valign=\"middle\" class=\"hpb-cnt-tb-cell2\" width=\"86\">' + lc[i] + '</td>');
          alltext.push('              </tr>');
        }
        alltext.push('            </tbody>');
        alltext.push('          </table>');
        texa.value = alltext.join('\n');
        addToLog('ソースコードを出力しました。');
      } else {
        addToLog('表を作成してから再度試行してください。');
      }
    }

    var outbtn = document.getElementById('outbtn');
    if (outbtn.addEventListener) {
      outbtn.addEventListener('click', function () { fOutbtn() });
    } else if (outbtn.attachEvent) {
      outbtn.attachEvent('click', function () { fOutbtn() });
    }

    function fCpbtn() {
      if (document.execCommand('Copy')) {
        tarea.select();
        document.execCommand('Copy');
        addToLog('クリップボードにコピーしました。（execCommand）');
      } else if (navigator.clipboard.writeText()) {
        navigator.clipboard.writeText(tarea.value);
        addToLog('クリップボードにコピーしました。（Clipboard API）');
      } else {
        addToLog('クリップボードにコピーできませんでした。');
      }
    }

    var cpbtn = document.getElementById('cpbtn');
    if (cpbtn.addEventListener) {
      cpbtn.addEventListener('click', function () { fCpbtn() });
    } else if (cpbtn.attachEvent) {
      cpbtn.attachEvent('click', function () { fCpbtn() });
    }

    function aDownload() {
      dllink.setAttribute('target', '_blank')
      dllink.setAttribute('href', objectURL);
      dllink.setAttribute('download', filename);
      dllink.click();
      dllink = document.createElement('a');
    }

    function fExbtn() {
      if (alltext.length != 15) {
        blob = new Blob([tarea.value], { type: 'text/plain' });
        if (window.navigator.msSaveBlob) {
          window.navigator.msSaveBlob(blob, filename);
          addToLog('ファイルに書き出しました。（msSaveBlob）');
        } else if (window.URL && window.URL.createObjectURL) {
          objectURL = window.URL.createObjectURL(blob);
          aDownload();
          addToLog('ファイルに書き出しました。（window.URL）');
          window.URL.revokeObjectURL(objectURL);
        } else if (window.webkitURL && window.webkitURL.createObject) {
          objectURL = window.webkitURL.createObjectURL(blob);
          aDownload()
          addToLog('ファイルに書き出しました。（window.webkitURL）');
          window.webkitURL.revokeObjectURL(objectURL);
        }
      } else {
        addToLog('出力ボタンを押してから再度試行してください。');
      }
    }

    var exbtn = document.getElementById('exbtn');
    if (exbtn.addEventListener) {
      exbtn.addEventListener('click', function () { fExbtn() });
    } else if (exbtn.attachEvent) {
      exbtn.attachEvent('click', function () { fExbtn() });
    }

    function fRoaderA() {
      if (roaderA.files.length !== 0) {
        if (roaderA.files[0].name.match(/\d{4}_\d{1,2}\.txt/)) {
          owbox.checked = false;
          owtr.removeAttribute('style');
          addToLog('テキストファイルが選択されました。');
        } else {
          addToLog('間違ったファイルの可能性があります。ファイルを確認してください。');
        }
      }
    }

    if (roaderA.addEventListener) {
      roaderA.addEventListener('change', function () { fRoaderA() });
    } else if (roaderA.attachEvent) {
      roaderA.attachEvent('change', function () { fRoaderA() });
    }



    function fRoaderB() {
      if (roaderB.files.length != 0) {
        fReader0.readAsText(roaderB.files[0]);
        ex0disp.removeAttribute('style');
        addToLog('HTMLファイルが選択されました。');
      } else if (roaderB.files.length == 0) {
        ex0disp.setAttribute('style', 'display: none;');
      }
    }

    if (roaderB.addEventListener) {
      roaderB.addEventListener('change', function () { fRoaderB() });
    } else if (roaderB.attachEvent) {
      roaderB.attachEvent('change', function () { fRoaderB() });
    }

    function fExbtn0() {
      if (fReader0.readyState == 2 && alltext.length != 15 && roaderB.files.length != 0) {
        filename = y + '_' + mb + '.html';
        var types = 'text/html';
        blob_content = fReader0.result.replace(replacetext7, tarea.value);
        if (rCUTF8.checked == true) {
          var rtoc = 'charset=' + cset.value + '\"';
          if (!blob_content.match(rtoc)) {
            blob_content = blob_content.replace(replacetext8, rtoc);
            addToLog('charsetを' + cset.value + 'に置き換えました。');
          }
        } else if (pSJIS.checked == true) {
          if (!blob_content.match('charset=Shift-JIS\"')) {
            blob_content = blob_content.replace(replacetext8, 'charset=Shift-JIS\"');
            addToLog('charsetをShift-JISに置き換えました。');
          }
          types = 'text/html; charset=shift_jis';
          var detected = Encoding.detect(blob_content);
          var ucList = [];
          for (var i = 0; i < blob_content.length; i += 1) { ucList.push(blob_content.charCodeAt(i)); }
          blob_content = new Uint8Array(Encoding.convert(ucList, { to: 'SJIS', from: detected }));
        } else if (jUTF8.checked == true) {
          addToLog('操作は行われませんでした。');
        }
        var blob = new Blob([blob_content], { type: types });
        if (window.navigator.msSaveBlob) {
          window.navigator.msSaveBlob(blob, filename);
          addToLog('HTMLファイルに書き出しました。（msSaveBlob）');
        } else if (window.URL && window.URL.createObjectURL) {
          objectURL = window.URL.createObjectURL(blob);
          aDownload()
          window.URL.revokeObjectURL(objectURL);
          addToLog('HTMLファイルに書き出しました。（window.URL）');
        } else if (window.webkitURL && window.webkitURL.createObject) {
          objectURL = window.webkitURL.createObjectURL(blob);
          aDownload()
          window.webkitURL.revokeObjectURL(objectURL);
          addToLog('HTMLファイルに書き出しました。（window.webkitURL）');
        } else {
          addToLog('書き出しに問題が発生しました。');
        } if (tarea.value.length < 16227) {
          addToLog('テキストエリアの文字数が想定よりも少ないため、書き出されたコードで何らかの問題が発生する可能性があります。');
        }
      } else if (fReader0.readyState != 2) {
        addToLog('現在、ファイルの読み込み中です。5秒以上経ってからもう一度お試しください。');
      } else if (alltext.length == 15) {
        addToLog('出力ボタンを押してから再度試行してください。');
      } else if (roaderB.files.length == 0) {
        addToLog('何かがおかしいような気がしますが、少なくともファイルが読み込まれていないのは確かです。');
      } else {
        addToLog('予期せぬ問題が発生しました。');
      }
    }

    if (exbtn0.addEventListener) {
      exbtn0.addEventListener('click', function () { fExbtn0() });
    } else if (exbtn0.attachEvent) {
      exbtn0.attachEvent('click', function () { fExbtn0() });
    }

    var weekWhite = document.getElementsByClassName('white');
    var weekFuchsia = document.getElementsByClassName('fuchsia');
    var weekAqua = document.getElementsByClassName('aqua');
    var todoBlack = document.getElementsByClassName('black');
    var todoRed = document.getElementsByClassName('red');
    var todoBlue = document.getElementsByClassName('blue');
    function roadFromFile() {
      if (trcn2.length != 1 && fArrayCustom.length != 0) {
        for (var i = 1; trcn2.length != 1; i++) {
          tbody.removeChild(trcn2[1]);
        }
        for (i = 0; i < fArrayCustom.length; i++) {
        }
      }
      for (i = 0; i < ll; i++) {
        var ii = i + 1;
        var b = 'b' + ii;
        var c = 'c' + ii;
        var d = 'd' + ii;
        var e = 'e' + ii;
        if (fArrayWeek[i].replace(replacetext1, '').replace(replacetext2, '') == 'white') {
          weekWhite[i].setAttribute('selected', 'true');
          cattr(d, e);
        } else if (fArrayWeek[i].replace(replacetext1, '').replace(replacetext2, '') == 'fuchsia') {
          weekFuchsia[i].setAttribute('selected', 'true');
          cattr(d, e);
        } else if (fArrayWeek[i].replace(replacetext1, '').replace(replacetext2, '') == 'aqua') {
          weekAqua[i].setAttribute('selected', 'true');
          cattr(d, e);
        }
        if (fArrayTodo[i].replace(replacetext3, '').replace(replacetext4, '') == 'black') {
          todoBlack[i].setAttribute('selected', 'true');
        } else if (fArrayTodo[i].replace(replacetext3, '').replace(replacetext4, '') == 'red') {
          todoRed[i].setAttribute('selected', 'true');
        } else if (fArrayTodo[i].replace(replacetext3, '').replace(replacetext4, '') == 'blue') {
          todoBlue[i].setAttribute('selected', 'true');
        }

        var iTodo = fArrayTodo[i].replace(replacetext5, '').replace('</td>', '');
        if (iTodo != '') {
          document.getElementById(b).value = iTodo;
        }

        var iSchedule = fArraySchdule[i].replace(replacetext6, '').replace('</td>', '');
        if (iSchedule != '') {
          document.getElementById(c).value = iSchedule;
        }
      }
      addToLog(y + '年' + mb + '月の表をロードしました。');
    }

    var gNum;
    var nts = [];

    function dcEsA(eType, attr) {
      var ele = document.createElement(eType);
      for (var p in attr) { ele.setAttribute(attr[p][0], attr[p][1]) };
      return ele;
    }
    function dgEBI(id) { return document.getElementById(id); }

    function cHidden(ele, ela, elb) {
      if (ele.checked == true) {
        ela.removeAttribute('style');
        elb.setAttribute('style', 'display: none;');
      } else if (ele.checked == false) {
        ela.setAttribute('style', 'display: none;');
        elb.removeAttribute('style');
      }
    }

    function cHiddenD(ela, elb) {
      if (ela.getAttribute('style') == 'display: none;') {
        ela.removeAttribute('style');
        elb.setAttribute('style', 'display: none;');
      } else if (ela.getAttribute('style') == '' | ela.getAttribute('style') == null) {
        ela.setAttribute('style', 'display: none;');
        elb.removeAttribute('style');
      }
    }

    function ctdelF(stat, num) {
      if (stat == 'no') {
        dgEBI('ct' + num + 'del').removeAttribute('style');
        dgEBI('ct' + num + 'dels').setAttribute('style', 'display: none;');
      } else if (stat == 'yes') {
        dgEBI('tbd').removeChild(dgEBI('ct' + num + 't'));
        dgEBI('tbd').removeChild(dgEBI('ct' + num + 's'));
        nts = nts.filter(function (tgt) { return tgt != num; });
        addToLog('カスタムテキストを削除しました。');
      }
    }

    function thif(elem, mat) {
      var r = elem.getAttribute('id');
      for (var u in mat) { r = r.replace(mat[u], '') };
      return r;
    }

    function addctf() {
      if (nts.length == 0) {
        gNum = '0';
        nts.push(0);
      } else if (nts.length != 0) {
        gNum = String(nts[nts.length - 1] + 1);
        nts.push(nts[nts.length - 1] + 1);
      }
      var ctt0 = dcEsA('tr', [['id', 'ct' + gNum + 't']]);
      var ctt0td = dcEsA('td', [['colspan', '4']]);
      var cttv = dcEsA('input', [['id', 'ct' + gNum + 'tv'], ['type', 'text'], ['size', '70']]);
      ctt0td.appendChild(cttv);
      ctt0td.appendChild(document.createElement('br'));
      var cttbr = dcEsA('button', [['id', 'ct' + gNum + 'tbr'], ['type', 'button']]);
      cttbr.innerText = '改行';
      ctt0td.appendChild(cttbr);
      var cttst = dcEsA('button', [['id', 'ct' + gNum + 'tst'], ['type', 'button']]);
      cttst.innerText = '書式設定を縮小';
      ctt0td.appendChild(cttst);
      ctt0.appendChild(ctt0td);
      dgEBI('tbd').appendChild(ctt0);

      var cts0 = dcEsA('tr', [['id', 'ct' + gNum + 's']]);
      var cts0td = document.createElement('td');
      cts0td.appendChild(document.createTextNode('テキストの色'));
      cts0td.appendChild(document.createElement('br'));
      var label0 = document.createElement('label');
      var ctsc16 = dcEsA('input', [['id', 'ct' + gNum + 'sc16'], ['type', 'radio'], ['name', 'ct' + gNum + 'sc'], ['value', 'st16'], ['checked', 'checked']]);
      label0.appendChild(ctsc16);
      label0.appendChild(document.createTextNode('標準16色'));
      cts0td.appendChild(label0);
      var cts16v = dcEsA('select', [['id', 'ct' + gNum + 's16v']]);
      var list0 = ['black', 'red', 'blue', 'fuchsia', 'aqua', 'lime', 'gray', 'maroon', 'purple', 'green', 'olive', 'navy', 'teal', 'silver', 'white'];
      for (var p in list0) {
        var option = document.createElement('option');
        option.text = list0[p];
        option.value = list0[p];
        cts16v.appendChild(option);
      }
      var ctscca = dcEsA('span', [['id', 'ct' + gNum + 'scca']]);
      ctscca.appendChild(document.createElement('br'));
      ctscca.appendChild(cts16v);
      cts0td.appendChild(ctscca);
      cts0td.appendChild(document.createElement('br'));
      var label1 = document.createElement('label');
      var ctscc = dcEsA('input', [['id', 'ct' + gNum + 'scc'], ['type', 'radio'], ['name', 'ct' + gNum + 'sc'], ['value', 'custom']]);
      label1.appendChild(ctscc);
      label1.appendChild(document.createTextNode('カスタムの色'));
      cts0td.appendChild(label1);
      var ctsccb = dcEsA('span', [['id', 'ct' + gNum + 'sccb'], ['style', 'display: none;']]);
      ctsccb.appendChild(document.createElement('br'));
      ctsccb.appendChild(document.createTextNode('#'));
      var ctsccv = dcEsA('input', [['id', 'ct' + gNum + 'sccv'], ['type', 'text'], ['size', '6'], ['minlength', '3'], ['maxlength', '6'], ['value', '000000']]);
      ctsccb.appendChild(ctsccv);
      cts0td.appendChild(ctsccb);
      cts0.appendChild(cts0td);

      var cts1td = document.createElement('td');
      cts1td.appendChild(document.createTextNode('テキストのサイズ'));
      cts1td.appendChild(document.createElement('br'));
      var label2 = document.createElement('label');
      var ctstsn = dcEsA('input', [['id', 'ct' + gNum + 'stsn'], ['type', 'radio'], ['name', 'ct' + gNum + 'sts'], ['value', 'named'], ['checked', 'checked']]);
      label2.appendChild(ctstsn);
      label2.appendChild(document.createTextNode('名前付きのサイズ'));
      cts1td.appendChild(label2);
      var ctstca = dcEsA('span', [['id', 'ct' + gNum + 'stca']]);
      var ctstsnv = dcEsA('select', [['id', 'ct' + gNum + 'stsnv']]);
      var list1 = ['大+++', '大++', '大+', '大', '中', '小', '小-', '小--'];
      var list2 = ['xxx-large', 'xx-large', 'x-large', 'large', 'medium', 'small', 'x-small', 'xx-small'];
      for (var p in list1) {
        var option = document.createElement('option');
        option.text = list1[p];
        option.value = list2[p];
        ctstsnv.appendChild(option);
      }
      ctstca.appendChild(document.createElement('br'));
      ctstca.appendChild(ctstsnv);
      cts1td.appendChild(ctstca);
      cts1td.appendChild(document.createElement('br'));
      var label3 = document.createElement('label');
      var ctstsc = dcEsA('input', [['id', 'ct' + gNum + 'stsc'], ['type', 'radio'], ['name', 'ct' + gNum + 'sts'], ['value', 'custom']]);
      label3.appendChild(ctstsc);
      label3.appendChild(document.createTextNode('カスタムのサイズ'));
      cts1td.appendChild(label3);
      var ctstcb = dcEsA('span', [['id', 'ct' + gNum + 'stcb'], ['style', 'display: none;']]);
      var ctstsv = dcEsA('input', [['id', 'ct' + gNum + 'stsv'], ['type', 'text'], ['value', '24'], ['size', '5'], ['minlength', '1']]);
      ctstcb.appendChild(document.createElement('br'));
      ctstcb.appendChild(ctstsv);
      var ctstsvs = dcEsA('select', [['id', 'ct' + gNum + 'stsvs']]);
      var list4 = ['px', 'em', 'rem'];
      for (var p in list4) {
        var option = document.createElement('option');
        option.text = list4[p];
        option.value = list4[p];
        ctstsvs.appendChild(option);
      }
      ctstcb.appendChild(ctstsvs);
      cts1td.appendChild(ctstcb);
      cts0.appendChild(cts1td);

      var cts2td = document.createElement('td');
      var list5 = ['b', 'i', 'u', 's'];
      var list6 = ['太字', '斜体', '下線', '取り消し'];
      for (var p in list5) {
        var label4 = document.createElement('label');
        var ctse = dcEsA('input', [['id', 'ct' + gNum + 'se' + list5[p]], ['type', 'checkbox']]);
        var fx = document.createElement(list5[p]);
        fx.appendChild(document.createTextNode(list6[p]));
        label4.appendChild(ctse);
        label4.appendChild(fx);
        cts2td.appendChild(label4);
        if (p == 1) {
          cts2td.appendChild(document.createElement('br'));
        }
      }
      cts0.appendChild(cts2td);

      var cts3td = document.createElement('td');
      var ctdel = dcEsA('button', [['id', 'ct' + gNum + 'del'], ['type', 'button']]);
      ctdel.appendChild(document.createTextNode('このカスタムテキストを削除する'));
      cts3td.appendChild(ctdel);
      var ctdels = dcEsA('span', [['id', 'ct' + gNum + 'dels'], ['style', 'display: none;']]);
      ctdels.appendChild(document.createTextNode('このカスタムテキストの内容は失われますが、'));
      ctdels.appendChild(document.createElement('br'));
      ctdels.appendChild(document.createTextNode('よろしいですか？'));
      ctdels.appendChild(document.createElement('br'));
      var label5 = document.createElement('label');
      var ctdely = dcEsA('input', [['id', 'ct' + gNum + 'dely'], ['type', 'checkbox']]);
      label5.appendChild(ctdely);
      label5.appendChild(document.createTextNode('はい'));
      ctdels.appendChild(label5);
      var label6 = document.createElement('label');
      var ctdeln = dcEsA('input', [['id', 'ct' + gNum + 'deln'], ['type', 'checkbox']]);
      label6.appendChild(ctdeln);
      label6.appendChild(document.createTextNode('いいえ'));
      ctdels.appendChild(label6);
      cts3td.appendChild(ctdels);
      cts0.appendChild(cts3td);
      dgEBI('tbd').appendChild(cts0);

      dgEBI('ct' + gNum + 'tst').addEventListener('click', function () {
        var num = thif(this, ['ct', 'tst']);
        if (dgEBI('ct' + num + 's').getAttribute('style') == 'display: none;') {
          dgEBI('ct' + num + 's').removeAttribute('style');
          dgEBI('ct' + num + 'tst').innerText = '書式設定を縮小';
        } else if (dgEBI('ct' + num + 's').getAttribute('style') == '' | dgEBI('ct' + num + 's').getAttribute('style') == null) {
          dgEBI('ct' + num + 's').setAttribute('style', 'display: none;');
          dgEBI('ct' + num + 'tst').innerText = '書式設定を展開';
        }
      });
      dgEBI('ct' + gNum + 'tbr').addEventListener('click', function () { insertBrTag(dgEBI('ct' + thif(this, ['ct', 'tbr']) + 'tv')); });
      dgEBI('ct' + gNum + 'sc16').addEventListener('click', function () { cHidden(this, dgEBI('ct' + thif(this, ['ct', 'sc16']) + 'scca'), dgEBI('ct' + thif(this, ['ct', 'sc16']) + 'sccb')); });
      dgEBI('ct' + gNum + 'scc').addEventListener('click', function () { cHidden(this, dgEBI('ct' + thif(this, ['ct', 'scc']) + 'sccb'), dgEBI('ct' + thif(this, ['ct', 'scc']) + 'scca')); });
      dgEBI('ct' + gNum + 'stsn').addEventListener('click', function () { cHidden(this, dgEBI('ct' + thif(this, ['ct', 'stsn']) + 'stca'), dgEBI('ct' + thif(this, ['ct', 'stsn']) + 'stcb')); });
      dgEBI('ct' + gNum + 'stsc').addEventListener('click', function () { cHidden(this, dgEBI('ct' + thif(this, ['ct', 'stsc']) + 'stcb'), dgEBI('ct' + thif(this, ['ct', 'stsc']) + 'stca')); });
      dgEBI('ct' + gNum + 'del').addEventListener('click', function () { cHiddenD(dgEBI('ct' + thif(this, ['ct', 'del']) + 'dels'), dgEBI('ct' + thif(this, ['ct', 'del']) + 'del')); });
      dgEBI('ct' + gNum + 'dely').addEventListener('click', function () { ctdelF('yes', thif(this, ['ct', 'dely'])); });
      dgEBI('ct' + gNum + 'deln').addEventListener('click', function () { ctdelF('no', thif(this, ['ct', 'deln'])); });
      addToLog('新しいカスタムテキストを追加しました。');
      return gNum;
    }

    dgEBI('addct').addEventListener('click', function () { addctf() });

    function fOwbox() {
      owtr.setAttribute('style', 'display: none;');
      if (owbox.checked) {
        files = roaderA.files;
        rYear = files[0].name.match(/\d{4}/)[0];
        rMonth = files[0].name.match(/_\d+/)[0].replace('_', '');
        yearin.value = rYear;
        monthin.value = rMonth;
        y = yearin.value;
        mb = monthin.value;
        m = mb - 1;
        newDate = new Date(y, mb, 1);
        newDate.setFullYear(y);
        newDate.setMonth(mb);
        newDate.setDate(0);
        l = newDate.getDate() + 1;
        ll = newDate.getDate();
        filename = y + '_' + mb + '.txt';
        alltext_set();
        generating();
        fReader.readAsText(files[0]);
        fReader.onload = function () {
          fArrayWeek = fReader.result.match(matchRegxp1);
          fArrayTodo = fReader.result.match(matchRegxp2);
          fArraySchdule = fReader.result.match(matchRegxp3);
          fArrayCustom = fReader.result.match(matchRegxp4);
          roadFromFile();
        }
      }
      owbox.checked = false;
    }

    if (owbox.addEventListener) {
      owbox.addEventListener('change', function () { fOwbox() });
    } else if (owbox.attachEvent) {
      owbox.attachEvent('change', function () { fOwbox() });
    }

    if (new Blob()) {
      exbtn.removeAttribute('disabled');
    }

    if (new FileReader()) {
      roaderA.removeAttribute('disabled');
      fReader = new FileReader();
    }
    if (new Uint8Array()) {
      pSJIS.removeAttribute('disabled');
      roaderB.removeAttribute('disabled');
      fReader0 = new FileReader();
    }
  </script>

</body>

</html>
